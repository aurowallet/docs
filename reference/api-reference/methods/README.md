# Methods


### **getAccounts**

Used for website request connected account.

```javascript
window.mina.getAccounts(): Promise<string[]>;
```

```javascript
// accounts is an array that contains approve account's address,if no account, will back []
const accounts = await window.mina.getAccounts()
```

### **requestAccounts**

Used for the mina account of the website requesting to connect to the user, if authorized, it will directly return to the current authorized account.

```javascript
interface ProviderError extends Error {
  message: string;
  code: number;
  data?: unknown;
}

window.mina.requestAccounts(): Promise<string[]|ProviderError>;
```

```javascript
let accounts
// data.result is an array that contains approve account's address
try {
  accounts = await window.mina.requestAccounts()
} catch (error) {
  // if user reject, requestAccounts will throw an error with code and message filed
  console.log(error.message, error.code)
}
```

### **requestNetwork**

Request which type of network is using. current chainId contains ["mainnet", "devnet", "berkeley", "testworld2"]

```javascript
type ChainInfoArgs ={
  chainId:string,
  name:string,
}

window.mina.requestNetwork(): Promise<ChainInfoArgs>;
```

```javascript
const network = await window.mina.requestNetwork();
console.log(network)
```

### sendTransaction

This function can sign messages, sign and broadcast payments, stake delegations, and zk-commond. If the payload is unrecognized, an Error is thrown.

{% hint style="warning" %}
&#x20;sendTransaction can only be used in Berkeley Network for now.
{% endhint %}

```javascript
interface SendTransactionArgs {
  transaction: any,
  feePayer?: {
    fee?: number,
    memo?: string
  };
}

type SendTransactionResult = {
  hash: string
}

interface ProviderError extends Error {
  message: string;
  code: number;
  data?: unknown;
}


window.mina.sendTransaction(args: SendTransactionArgs): Promise<SendTransactionResult | ProviderError>;
```

```javascript
// send zkApp transaction
// partiesJson is generated by snarkyjs, you can check the link below for more info
// https://docs.minaprotocol.com/en/zkapps/how-zkapps-work
try {
  const partiesJson = '{"feePayer":{"body":{"publicKey":"B62qiTKpEPjGTSHZrtM8uXiKgn8So916pLmNJKDhKeyBQL9TDb3nvBG","update":{"appState":[null,null,null,null,null,null,null,null],"delegate":null,"verificationKey":null,"permissions":null,"zkappUri":null,"tokenSymbol":null,"timing":null,"votingFor":null},"fee":"0","events":[],"sequenceEvents":[],"networkPrecondition":{"snarkedLedgerHash":null,"timestamp":null,"blockchainLength":{"lower":"0","upper":"4294967295"},"minWindowDensity":{"lower":"0","upper":"4294967295"},"totalCurrency":{"lower":"0","upper":"18446744073709551615"},"globalSlotSinceHardFork":{"lower":"0","upper":"4294967295"},"globalSlotSinceGenesis":{"lower":"0","upper":"4294967295"},"stakingEpochData":{"ledger":{"hash":null,"totalCurrency":{"lower":"0","upper":"18446744073709551615"}},"seed":null,"startCheckpoint":null,"lockCheckpoint":null,"epochLength":{"lower":"0","upper":"4294967295"}},"nextEpochData":{"ledger":{"hash":null,"totalCurrency":{"lower":"0","upper":"18446744073709551615"}},"seed":null,"startCheckpoint":null,"lockCheckpoint":null,"epochLength":{"lower":"0","upper":"4294967295"}}},"nonce":"0"},"authorization":"7mWxjLYgbJUkZNcGouvhVj5tJ8yu9hoexb9ntvPK8t5LHqzmrL6QJjjKtf5SgmxB4QWkDw7qoMMbbNGtHVpsbJHPyTy2EzRQ"},"otherParties":[{"body":{"publicKey":"B62qqmHWbrHaWDxcp5MGLSQZHaTTv4jwxpr8gCvTsSGiFE6TPb6kXag","tokenId":"wSHV2S4qX9jFsLjQo8r1BsMLH2ZRKsZx6EJd1sbozGPieEC4Jf","update":{"appState":["6",null,null,null,null,null,null,null],"delegate":null,"verificationKey":null,"permissions":null,"zkappUri":null,"tokenSymbol":null,"timing":null,"votingFor":null},"balanceChange":{"magnitude":"0","sgn":"Positive"},"incrementNonce":false,"events":[],"sequenceEvents":[],"callData":"0","callDepth":0,"preconditions":{"network":{"snarkedLedgerHash":null,"timestamp":null,"blockchainLength":{"lower":"0","upper":"4294967295"},"minWindowDensity":{"lower":"0","upper":"4294967295"},"totalCurrency":{"lower":"0","upper":"18446744073709551615"},"globalSlotSinceHardFork":{"lower":"0","upper":"4294967295"},"globalSlotSinceGenesis":{"lower":"0","upper":"4294967295"},"stakingEpochData":{"ledger":{"hash":null,"totalCurrency":{"lower":"0","upper":"18446744073709551615"}},"seed":null,"startCheckpoint":null,"lockCheckpoint":null,"epochLength":{"lower":"0","upper":"4294967295"}},"nextEpochData":{"ledger":{"hash":null,"totalCurrency":{"lower":"0","upper":"18446744073709551615"}},"seed":null,"startCheckpoint":null,"lockCheckpoint":null,"epochLength":{"lower":"0","upper":"4294967295"}}},"account":{"balance":{"lower":"0","upper":"18446744073709551615"},"nonce":{"lower":"0","upper":"4294967295"},"receiptChainHash":null,"delegate":null,"state":[null,null,null,null,null,null,null,null],"sequenceState":"19777675955122618431670853529822242067051263606115426372178827525373304476695","provedState":null}},"useFullCommitment":false,"caller":"wSHV2S4qX9jFsLjQo8r1BsMLH2ZRKsZx6EJd1sbozGPieEC4Jf"},"authorization":{"proof":"...KQ==","signature":null}}],"memo":"E4YM2vTHhWEg66xpj52JErHUBU4pZ1yageL4TVDDpTTSsv8mK6YaH"}'
  
  const { hash } = await window.mina.sendTransaction({
    transaction: partiesJson,
    feePayer: {
      fee: 0.1,
      memo: "zk"
    }
  })
  console.log(hash)
} catch (error) {
  console.log(error.message, error.code)
}
```


### **signMessage**

Used for signature.

```javascript
interface SignMessageArgs {
  message: string
}

interface SignedData {
  publicKey: string,
  data: string,
  signature: {
    field: string,
    scalar: string
  }
}

window.mina.signMessage(args: SignMessageArgs): Promise<SignedData | ProviderError>;
```

```javascript
try {
  let signResult = await window.mina.signMessage({
    message: "messages...",
  })
  console.log(signResult)
} catch(error) {
  console.log(error.message, error.code)
}
```


### **verifyMessage**

Used for verify signature information.

```javascript
interface VerifyMessageArgs {
  publicKey: string,
  data: string,
  signature: {
    field: string,
    scalar: string
  }
}

window.mina.verifyMessage(args: VerifyMessageArgs): Promise<boolean | ProviderError>;
```

```javascript
let messageVerifyResult: boolean = await window.mina.verifyMessage({
  publicKey: "B62qpjxUpgdjzwQfd8q2gzxi99wN7SCgmofpvw27MBkfNHfHoY2VH32",
  data: "messages...",
  signature: {
    field: "signature filed...",
    scalar: "scalar..."
  },
})
```
### **signJsonMessage**

Used for sign Json data. `since mina-signer 0.2.7`


```javascript
type JsonMessageData  = {
  label:string
  value:string
}
interface SignJsonMessageArgs {
  readonly message: Array<JsonMessageData>
}

interface SignedData {
  publicKey: string,
  data: string,
  signature: {
    field: string,
    scalar: string
  }
}

window.mina.signJsonMessage(args: SignMessageArgs): Promise<SignedData | ProviderError>;
```

```javascript
try {
  let signResult = await window.mina.signJsonMessage({
    message: [
      { label: "Label:", value: "Sign Confirm" },
      {
        label: "Message:",
        value: "Click to sign in and accept the Terms of Service",
      },
      {
        label: "URI:",
        value: "window.location.href",
      },
      {
        label: "Chain ID:",
        value: network.chainId,
      },
      {
        label: "Chain Name:",
        value: network.name,
      },
      {
        label: "Issued At:",
        value: new Date().getTime(),
      },
      {
        label: "Resources:",
        value: "https://docs.aurowallet.com/",
      },
    ],
  })
  console.log(signResult)
} catch(error) {
  console.log(error.message, error.code)
}
```

### **verifyJsonMessage**
Used for verify Json messgae information. `since mina-signer 0.2.7`

```javascript
interface VerifyMessageArgs {
  publicKey: string,
  data: string,
  signature: {
    field: string,
    scalar: string
  }
}

window.mina.verifyJsonMessage(args: VerifyJsonMessageArgs): Promise<boolean | ProviderError>;
```

```javascript
let messageVerifyResult: boolean = await window.mina.verifyJsonMessage({
  publicKey: "B62qpjxUpgdjzwQfd8q2gzxi99wN7SCgmofpvw27MBkfNHfHoY2VH32",
  data: "messages...",
  signature: {
    field: "signature filed...",
    scalar: "scalar..."
  },
})
```

### **signFields**

Used for signature fields.

```javascript
type SignFieldsArguments = {
  message: (string|number)[],
}

type SignedFieldsData = {
  data: (string|number)[],
  signature:string
}


window.mina.signFields(args: SignFieldsArguments): Promise<SignedFieldsData | ProviderError>
```

```javascript
try {
  const signFieldsResult = await window.mina.signFields({
    message: [1,2,3],// or ["1","2","3"]
  }).catch(err => err)
  console.log(signFieldsResult)
} catch (error) {
  console.log(error.message, error.code)
}
```


### **verifyFields**

Used for verify signature fields information.

```javascript
interface VerifyFieldsArguments {
  publicKey: string,
  data: (string|number)[],
  signature:string
}

window.mina.verifyFields(args: VerifyFieldsArguments): Promise<boolean>;
```

```javascript
let fieldsVerifyResult:boolean = await window.mina.verifyMessage({
  publicKey: "B62...",
  signature: "signature result...',
  data: "sign field...",
})
```

### **createNullifier**
Used for create nullifier. `since mina-signer 0.2.7`

```javascript
type CreateNullifierArgs = {
  readonly message: bigint[]
}

type Group = {
  x: bigint;
  y: bigint;
};

type Nullifier = {
  publicKey: Group;
  public: {
    nullifier: Group;
    s: bigint;
  };
  private: {
    c: bigint;
    g_r: Group;
    h_m_pk_r: Group;
  };
};


window.mina.createNullifier(args: CreateNullifierArgs): Promise<Nullifier | ProviderError>
```

```javascript
try {
  const nullifierResult = await window.mina.createNullifier({
    message: [1,2,3],// or ["1","2","3"]
  }).catch(err => err)
  console.log(nullifierResult)
} catch (error) {
  console.log(error.message, error.code)
}
```


### **switchChain**
Used for switch extension wallet chain. `since mina-signer 0.2.7`
current support mainnet , devnet , berkeley , testworld2 , 

```javascript
type SwitchChainArgs = {
  readonly chainId: string
}

type ChainInfoArgs ={
  chainId:string,
  name:string,
}

window.mina.switchChain(args: SwitchChainArgs): Promise<ChainInfoArgs | ProviderError>
```

```javascript
try {
  const switchResult = await window.mina.switchChain({
    chainId: "mainnet"
  }).catch(err => err)
  console.log(switchResult)
} catch (error) {
  console.log(error.message, error.code)
}
```

### **addChain**
Used for add Chain or switch extension wallet chain. `since mina-signer 0.2.7`


```javascript
type AddChainArgs = {
  readonly url: string
  readonly name: string
}

type ChainInfoArgs ={
  chainId:string,
  name:string,
}

window.mina.addChain(args: AddChainArgs): Promise<ChainInfoArgs | ProviderError>
```

```javascript
try {
  const addResult = await window.mina.addChain({
    url: encodeURIComponent("graphQLUrl"),
    name: "networkName",
  }).catch(err => err)
  console.log(addResult)
} catch (error) {
  console.log(error.message, error.code)
}
```


## Legacy Methods

Legacy methods are discouraged, you may use these for some reason, but they may be removed from our support at any time.

### **sendLegacy**Payment

Sign and broadcast a payment transaction.

```javascript
interface SendPaymentArgs {
  to: string,
  amount: number,
  fee?: number,
  memo?: string
}

window.mina.sendLegacyPayment(args: SendPaymentArgs): Promise<BroadcastTransactionResult | ProviderError>;
```

```javascript
try {
  const { hash } = await window.mina.sendLegacyPayment({
    amount: 1,
    fee: 0.1,
    to: "B62qm3V7qSQ97Stgo2MXv4Apof2cVezZyP1VYJ8DfrVNy9yfqKZxLQf",
  })
  console.log(hash)
} catch (error) {
  console.log(error.message, error.code)
}
```

### **sendLegacyStake**Delegation

Sign and broadcast a skake delegation transaction.

```javascript
interface SendStakeDelegationArgs {
  to: string,
  fee?: number,
  memo?:string
}

window.mina.sendLegacyStakeDelegation(args: SendStakeDelegationArgs): Promise<BroadcastTransactionResult | ProviderError>;
```

```javascript
try {
  const { hash } = await window.mina.sendLegacyStakeDelegation({
    fee: 0.1,
    to: "B62qq3TQ8AP7MFYPVtMx5tZGF3kWLJukfwG1A1RGvaBW1jfTPTkDBW6",
  })
  console.log(hash)
} catch (error) {
  console.log(error.message, error.code)
}
```
